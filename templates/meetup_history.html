{% extends "base.html" %}

{% block page_settings %}
  {% set container_class = 'is-wide' %}
{% endblock %}

{% block content %}
<div class="meetup-history">

  <header class="meetup-history__header">
    <h2>ðŸ“… Meet-up History</h2>
    <div class="summary-box">
      <h3>{{ total_attended }}</h3>
      <p>Total meet-ups attended</p>
    </div>
  </header>

  <form method="get" class="sort-form">
    <label for="sort">Sort by</label>
    <select name="sort" id="sort" onchange="this.form.submit()">
      <option value="date_desc" {% if sort_by=='date_desc' %}selected{% endif %}>Newest first</option>
      <option value="date_asc" {% if sort_by=='date_asc' %}selected{% endif %}>Oldest first</option>
      <option value="title" {% if sort_by=='title' %}selected{% endif %}>Alphabetical</option>
    </select>
  </form>

  {% if meetups %}
    <ul class="meetup-list">
      {% for m in meetups %}
        <li class="meetup-card">
          {% if m.photo %}
            <img src="{{ m.photo }}" alt="{{ m.title }}" class="meetup-card__photo">
          {% else %}
            <div class="meetup-card__photo meetup-card__photo--placeholder"></div>
          {% endif %}
          <div class="meetup-card__body">
            <strong>{{ m.title }}</strong>
            <span class="meetup-card__date">{{ m.date|to_date }}</span>
          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="empty-state">No meet-ups found yet.</p>
  {% endif %}

  <div class="actions-row">
    <a href="{{ url_for('passport') }}" class="btn">â¬… Back to Passport</a>
  </div>
</div>

<style>
.meetup-history{display:flex;flex-direction:column;gap:20px;}
.meetup-history__header{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;gap:16px;}
.meetup-history__header h2{margin:0;}
.summary-box{background:#fff;padding:16px 24px;border-radius:16px;box-shadow:0 10px 24px rgba(15,23,42,0.12);text-align:center;min-width:200px;}
.summary-box h3{margin:0;color:#1d4ed8;font-size:1.8rem;}
.summary-box p{margin:6px 0 0;color:#64748b;font-weight:600;font-size:0.9rem;}
.sort-form{display:flex;align-items:center;gap:12px;align-self:flex-end;}
.sort-form label{font-weight:600;color:#475569;}
.sort-form select{padding:8px 12px;border-radius:12px;border:1px solid #d7dbe6;font-size:0.9rem;}
.meetup-list{list-style:none;padding:0;margin:0;display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;}
.meetup-card{display:flex;gap:14px;align-items:center;background:#fff;border-radius:16px;padding:16px;box-shadow:0 12px 28px rgba(15,23,42,0.12);}
.meetup-card__photo{width:60px;height:60px;border-radius:12px;object-fit:cover;box-shadow:0 6px 16px rgba(15,23,42,0.12);}
.meetup-card__photo--placeholder{background:linear-gradient(135deg,#e2e8f0,#cbd5f5);}
.meetup-card__body{display:flex;flex-direction:column;gap:4px;text-align:left;}
.meetup-card__body strong{font-size:1rem;color:#1f2937;}
.meetup-card__date{font-size:0.85rem;color:#64748b;font-weight:600;}
.actions-row{text-align:center;}
.btn{display:inline-flex;align-items:center;gap:6px;padding:10px 18px;background:#3a8dde;color:#fff;border-radius:999px;text-decoration:none;font-weight:600;box-shadow:0 8px 20px rgba(58,141,222,0.25);}
.empty-state{text-align:center;color:#64748b;font-weight:600;}
</style>
{% endblock %}
