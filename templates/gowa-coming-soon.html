{% extends "base.html" %}

{% block page_settings %}
  {% set container_class = 'is-cozy' %}
{% endblock %}

{% block content %}
  {% set soon_message = gowa_message or "Check back on 16/11/2025 to experience the full Pokemon GO: GO Wild Area - Doncaster celebration!" %}
  {% set return_date = gowa_return_date or "16/11/2025" %}
  {% set carousel_images = [
    url_for('static', filename='gowa/soon1.png'),
    url_for('static', filename='gowa/soon2.png'),
    url_for('static', filename='gowa/soon3.png'),
  ] %}
  <section class="gowa-coming-soon">
    <img
      src="{{ url_for('static', filename='gowa/logo.png') }}"
      alt="GO Wild Area emblem"
      class="gowa-coming-soon__logo"
    >
    <p class="gowa-coming-soon__eyebrow">GO Wild Area â€“ Doncaster</p>
    <h1 class="gowa-coming-soon__title">Coming Soon</h1>
    <p class="gowa-coming-soon__date">Launching {{ return_date }}</p>
    <p class="gowa-coming-soon__message">{{ soon_message }}</p>

    <div class="gowa-carousel" data-active-index="0">
      <div class="gowa-carousel__viewport">
        {% for image_url in carousel_images %}
          <img
            src="{{ image_url }}"
            alt="GO Wild Area sneak peek {{ loop.index }}"
            class="gowa-carousel__slide {% if loop.first %}is-active{% endif %}"
            data-slide="{{ loop.index0 }}"
            loading="{{ 'eager' if loop.first else 'lazy' }}"
          >
        {% endfor %}
      </div>
      <div class="gowa-carousel__controls" role="tablist" aria-label="Preview slides">
        {% for image_url in carousel_images %}
          <button
            type="button"
            class="gowa-carousel__dot {% if loop.first %}is-active{% endif %}"
            data-slide-target="{{ loop.index0 }}"
            role="tab"
            aria-selected="{{ 'true' if loop.first else 'false' }}"
          >
            {{ loop.index }}
          </button>
        {% endfor %}
      </div>
    </div>
    <div class="gowa-coming-soon__rsvp">
      <a
        class="gowa-coming-soon__rsvp-btn is-primary"
        href="https://cmpf.re/eO0zUY"
        target="_blank"
        rel="noopener"
      >
        RSVP Saturday on Campfire
      </a>
      <a
        class="gowa-coming-soon__rsvp-btn is-secondary"
        href="https://cmpf.re/P2Gs5E"
        target="_blank"
        rel="noopener"
      >
        RSVP Sunday on Campfire
      </a>
    </div>
    <button
      type="button"
      class="gowa-coming-soon__tester"
      data-test-gateway
      aria-label="Tester access"
      title="Tester access"
    >.</button>
  </section>

  <style>
    .gowa-coming-soon{min-height:60vh;padding:40px 16px;margin:0 auto;max-width:820px;text-align:center;display:flex;flex-direction:column;align-items:center;gap:16px;}
    .gowa-coming-soon__logo{width:140px;height:auto;filter:drop-shadow(0 15px 45px rgba(15,23,42,0.18));}
    .gowa-coming-soon__eyebrow{text-transform:uppercase;letter-spacing:0.15em;font-weight:600;color:#2563eb;margin-top:10px;}
    .gowa-coming-soon__title{font-size:2.5rem;margin:0;color:#0f172a;}
    .gowa-coming-soon__date{font-weight:600;color:#0ea5e9;text-transform:uppercase;letter-spacing:0.1em;margin:0;}
    .gowa-coming-soon__message{font-size:1.2rem;line-height:1.6;color:#1f2933;margin:0 0 12px;}
    .gowa-carousel{width:100%;background:#020617;border-radius:24px;padding:24px;box-shadow:0 20px 70px rgba(2,6,23,0.35);}
    .gowa-carousel__viewport{position:relative;width:100%;overflow:hidden;border-radius:18px;}
    .gowa-carousel__slide{width:100%;border-radius:18px;opacity:0;transform:scale(0.96);transition:opacity .35s ease,transform .35s ease;display:none;}
    .gowa-carousel__slide.is-active{opacity:1;transform:scale(1);display:block;}
    .gowa-carousel__controls{margin-top:18px;display:flex;justify-content:center;gap:12px;}
    .gowa-carousel__dot{width:38px;height:38px;border-radius:999px;border:1px solid rgba(255,255,255,0.4);background:transparent;color:#e2e8f0;font-weight:600;cursor:pointer;transition:background .2s ease,color .2s ease;}
    .gowa-carousel__dot.is-active{background:#e2e8f0;color:#020617;}
    .gowa-coming-soon__rsvp{display:flex;flex-wrap:wrap;gap:12px;margin-top:22px;}
    .gowa-coming-soon__rsvp-btn{flex:1 1 220px;text-align:center;padding:12px 22px;border-radius:999px;font-weight:600;text-decoration:none;letter-spacing:0.05em;transition:transform .2s ease,box-shadow .2s ease;}
    .gowa-coming-soon__rsvp-btn.is-primary{background:linear-gradient(135deg,#c084fc,#fb7185);color:#fff;box-shadow:0 16px 32px rgba(15,23,42,0.35);}
    .gowa-coming-soon__rsvp-btn.is-primary:hover{transform:translateY(-2px);box-shadow:0 18px 36px rgba(15,23,42,0.4);}
    .gowa-coming-soon__rsvp-btn.is-secondary{background:rgba(255,255,255,0.12);border:1px solid rgba(248,250,252,0.35);color:#f8fafc;}
    .gowa-coming-soon__rsvp-btn.is-secondary:hover{transform:translateY(-2px);box-shadow:0 18px 36px rgba(15,23,42,0.3);}
    .gowa-coming-soon__tester{margin-top:24px;width:44px;height:44px;border-radius:999px;border:1px solid rgba(15,23,42,0.15);background:#fff;color:#0f172a;font-size:1.4rem;line-height:1;cursor:pointer;opacity:0.4;transition:opacity .2s ease,transform .2s ease;}
    .gowa-coming-soon__tester:focus,
    .gowa-coming-soon__tester:hover{opacity:1;transform:scale(1.05);}
    @media (max-width:640px){
      .gowa-coming-soon__title{font-size:2rem;}
      .gowa-carousel{padding:18px;}
    }
  </style>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const carousel = document.querySelector(".gowa-carousel");
      if (!carousel) return;
      const slides = Array.from(carousel.querySelectorAll("[data-slide]"));
      const dots = Array.from(carousel.querySelectorAll("[data-slide-target]"));

      const activate = (nextIndex) => {
        slides.forEach((slide, idx) => {
          slide.classList.toggle("is-active", idx === nextIndex);
        });
        dots.forEach((dot, idx) => {
          const isActive = idx === nextIndex;
          dot.classList.toggle("is-active", isActive);
          dot.setAttribute("aria-selected", String(isActive));
        });
        carousel.dataset.activeIndex = nextIndex.toString();
      };

      dots.forEach((dot) => {
        dot.addEventListener("click", () => {
          const target = Number(dot.dataset.slideTarget);
          if (Number.isNaN(target)) return;
          activate(target);
        });
      });

      const testerButton = document.querySelector("[data-test-gateway]");
      if (testerButton) {
        testerButton.addEventListener("click", () => {
          const code = window.prompt("Enter access code");
          if (code === null) return;
          if (code.trim() === "4121") {
            window.location.href = "{{ url_for('live_events_page') }}";
          } else {
            window.alert("Incorrect code. Please try again.");
          }
        });
      }
    });
  </script>
{% endblock %}
