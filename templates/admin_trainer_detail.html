{% extends "base.html" %}

{% block page_settings %}
  {% set container_class = 'is-wide' %}
{% endblock %}

{% block content %}

<!-- Header -->
<div class="admin-header">
  <h1>üë§ Manage Trainer</h1>
  <p>Update details and stamps for <strong>{{ trainer.trainer_username }}</strong></p>
</div>

<!-- Trainer Card -->
<div class="trainer-detail-card">
  <img src="{{ url_for('static', filename='avatars/' ~ trainer.avatar_icon) }}" 
       alt="Avatar" class="avatar-lg">
  <h2>{{ trainer.trainer_username }}</h2>
  <p><strong>Account Type:</strong> {{ 'Standard' if trainer.account_type|lower == 'standard' else trainer.account_type }}</p>
  <p><strong>Campfire Username:</strong> {{ trainer.campfire_username or 'N/A' }}</p>
  <p><strong>Current Stamps:</strong> {{ trainer.stamps }}</p>
</div>

<!-- Management Actions -->
<div class="management-actions">
  <!-- Change Trainer Username -->
  <div class="action-box">
    <h3>üÜî Change Trainer Username</h3>
    <form action="{{ url_for('admin_change_trainer_username_v2', username=trainer.trainer_username) }}" method="post">
      <input type="text" name="new_trainer_username" value="{{ trainer.trainer_username }}" placeholder="New trainer username" required>
      <button type="submit">Update Username</button>
    </form>
    <p class="action-note">Updates their login name. Make sure the new username is unique.</p>
  </div>

  <!-- Add / Remove Stamps -->
  <div class="action-box">
    <h3>üéüÔ∏è Adjust Stamps</h3>
    <form action="{{ url_for('admin_adjust_stamps_v2', username=trainer.trainer_username) }}" method="post">
      <input type="number" name="count" placeholder="Amount" required>
      <input type="text" name="reason" placeholder="Reason (optional)">
      <select name="action" required>
        <option value="award">‚ûï Award</option>
        <option value="remove">‚ûñ Remove</option>
      </select>
      <button type="submit">Update Stamps</button>
    </form>
  </div>

  <!-- Change Account Type -->
  <div class="action-box">
    <h3>üëë Change Account Type</h3>
    <form action="{{ url_for('admin_change_account_type_v2', username=trainer.trainer_username) }}" method="post">
      <select name="account_type" required>
        <option value="standard" {% if trainer.account_type|lower == "standard" %}selected{% endif %}>Standard</option>
        <option value="Kids Account" {% if trainer.account_type == "Kids Account" %}selected{% endif %}>Kids Account</option>
        <option value="Admin" {% if trainer.account_type == "Admin" %}selected{% endif %}>Admin</option>
      </select>
      <button type="submit">Update Type</button>
    </form>
  </div>

  <!-- Reset PIN -->
  <div class="action-box">
    <h3>üîë Reset PIN</h3>
    <form action="{{ url_for('admin_reset_pin_v2', username=trainer.trainer_username) }}" method="post">
      <input type="password" name="new_pin" maxlength="4" pattern="\d{4}" placeholder="New 4-digit PIN" required>
      <button type="submit">Reset PIN</button>
    </form>
    <p class="action-note">PINs are required to be exactly 4 digits.</p>
  </div>

  <!-- Update Campfire Username -->
  <div class="action-box">
    <h3>üî• Campfire Username</h3>
    <form action="{{ url_for('admin_change_campfire_username_v2', username=trainer.trainer_username) }}" method="post">
      <input type="text" name="new_campfire_username" value="{{ trainer.campfire_username }}" placeholder="Campfire username (optional)">
      <button type="submit">Save Campfire</button>
    </form>
    <p class="action-note">Enter without the @ symbol. Leave blank to clear the saved Campfire username.</p>
  </div>

  <!-- Update Memorable Password -->
  <div class="action-box">
    <h3>üß† Memorable Password</h3>
    <form action="{{ url_for('admin_change_memorable_password_v2', username=trainer.trainer_username) }}" method="post">
      <input type="text" name="new_memorable_password" placeholder="New memorable password" required>
      <button type="submit">Update Memorable</button>
    </form>
    <p class="action-note">Players use this during recovery. Keep it easy to remember.</p>
  </div>

</div>

<div style="margin-top:20px; text-align:center;">
  <a href="{{ url_for('admin_trainers') }}" class="btn">‚¨Ö Back to Trainer Manager</a>
</div>

<style>
.admin-header { text-align:center; margin-bottom:20px; }
.admin-header h1 { margin:0; }
.admin-header p { color:#666; font-size:0.95em; }

.trainer-detail-card {
  background:#fff;
  border-radius:18px;
  padding:24px;
  text-align:center;
  margin-bottom:24px;
  box-shadow:0 12px 28px rgba(15,23,42,0.14);
}
.avatar-lg {
  width:100px;
  height:100px;
  border-radius:50%;
  border:3px solid #3a8dde;
  margin-bottom:12px;
  box-shadow:0 8px 20px rgba(58,141,222,0.25);
}

.management-actions {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap:18px;
}

.action-box {
  background:#fff;
  padding:18px;
  border-radius:16px;
  box-shadow:0 10px 24px rgba(15,23,42,0.12);
}
.action-box h3 {
  margin-top:0;
  font-size:1.1em;
  color:#3a8dde;
}
.action-box form {
  display:flex;
  flex-direction:column;
  gap:8px;
}
.action-box input, .action-box select {
  padding:10px 12px;
  border-radius:12px;
  border:1px solid #d7dbe6;
  font-size:0.95rem;
  transition:border-color .2s ease, box-shadow .2s ease;
}
.action-box input:focus, .action-box select:focus {
  outline:none; border-color:#3a8dde; box-shadow:0 0 0 3px rgba(58,141,222,0.2);
}
.action-box button {
  padding:10px 16px;
  border:none;
  background:#3a8dde;
  color:white;
  font-weight:600;
  border-radius:999px;
  cursor:pointer;
  box-shadow:0 8px 20px rgba(58,141,222,0.25);
  transition:transform .2s ease, box-shadow .2s ease;
}
.action-box button:hover {
  transform:translateY(-1px);
  box-shadow:0 12px 26px rgba(58,141,222,0.3);
}
.action-note {
  margin:6px 0 0;
  font-size:0.78rem;
  color:#6b7280;
}

.btn {
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:10px 18px;
  background:#3a8dde;
  color:#fff;
  border-radius:999px;
  text-decoration:none;
  font-weight:600;
  box-shadow:0 8px 20px rgba(58,141,222,0.25);
}
</style>

{% endblock %}
