{% extends "base.html" %}

{% block page_settings %}
  {% set container_class = 'is-wide' %}
{% endblock %}

{% block content %}

<section class="admin-leagues-hero">
  <div class="hero-overlay"></div>
  <div class="hero-content">
    <div class="hero-copy">
      <h1>üèÜ Leagues Control Center</h1>
      <p>Coordinate CDL pipelines, PvP tournaments, and live event quests from a single hub. Use these playbooks as you ship new modules.</p>
      <div class="hero-actions">
        <a href="{{ url_for('admin_leagues_pvp') }}" class="btn-primary">Open PvP Tournament Manager</a>
        <a href="#leagues-roadmap" class="btn-secondary">View Roadmap</a>
      </div>
    </div>
    <div class="hero-highlights">
      <div class="highlight-card">
        <span class="highlight-label">League Profile</span>
        <p>Build a unified profile with standings, streaks, and reward history across every league.</p>
      </div>
      <div class="highlight-card">
        <span class="highlight-label">Live Ops</span>
        <p>Flip tournaments into live mode, manage brackets, and broadcast results in real time.</p>
      </div>
    </div>
  </div>
</section>

<nav class="leagues-tabs" aria-label="Leagues sections">
  {% for mode in league_modes %}
    <button class="leagues-tab {% if loop.first %}is-active{% endif %}" data-tab="{{ mode.key }}">
      {{ mode.title }}
    </button>
  {% endfor %}
</nav>

<div class="leagues-panels">
  {% for mode in league_modes %}
    <section class="league-panel {% if loop.first %}is-active{% endif %}" data-panel="{{ mode.key }}">
      <header class="panel-header">
        <div>
          <h2>{{ mode.title }}</h2>
          <p>{{ mode.summary }}</p>
        </div>
        <span class="panel-pill">Phase: Discovery</span>
      </header>

      <div class="panel-grid">
        <article class="panel-card">
          <h3>Core Features</h3>
          <ul>
            {% for item in mode.features %}
              <li>{{ item }}</li>
            {% endfor %}
          </ul>
        </article>
        <article class="panel-card">
          <h3>Future Vision</h3>
          <ul>
            {% for item in mode.future %}
              <li>{{ item }}</li>
            {% endfor %}
          </ul>
        </article>
      </div>

      {% if mode.key == "cdl" %}
        <div class="panel-card panel-card--wide">
          <h3>Data Pipeline Checklist</h3>
          <ol>
            <li>Confirm Supabase sync for the CDL Google Sheet (live standings + archive tables).</li>
            <li>Design trainer-facing scorecards with headline metrics, win/loss charts, and placement badges.</li>
            <li>Surface historical seasons with filters by cup, region, and featured Pok√©mon.</li>
          </ol>
        </div>
      {% elif mode.key == "pvp" %}
        <div class="panel-card panel-card--wide">
          <h3>Live Operations Notes</h3>
          <p>When a meetup league goes live, admins should be able to flip the league status to ‚ÄúLive‚Äù so players begin submitting rounds immediately. Consider on-the-spot updates for:</p>
          <ul>
            <li>Cup rules and restricted Pok√©mon lists.</li>
            <li>Round pairings with real-time progression.</li>
            <li>Live leaderboard refreshes while the meetup runs.</li>
          </ul>
        </div>
      {% elif mode.key == "limited" %}
        <div class="limited-state-grid">
          <article class="panel-card">
            <h3>Inactive State</h3>
            <p>{{ live_event_settings.inactive_copy }}</p>
            <p class="muted">Keep this message as the default when no event is running.</p>
          </article>
          <article class="panel-card">
            <h3>Active Theme Preview</h3>
            <p>Next test event: <strong>{{ live_event_settings.theme }}</strong></p>
            <p>Switching the hub to active mode reveals themed visuals, live activities, and call-to-actions for attendees.</p>
          </article>
        </div>
        <div class="panel-card panel-card--wide">
          <h3>Live Event Activities</h3>
          <div class="activity-grid">
            {% for activity in live_event_settings.activities %}
              <section class="activity-card">
                <h4>{{ activity.title }}</h4>
                <ul>
                  {% for detail in activity.details %}
                    <li>{{ detail }}</li>
                  {% endfor %}
                </ul>
              </section>
            {% endfor %}
            <section class="activity-card">
              <h4>More Ideas</h4>
              <ul>
                <li>Add scavenger hunts, city photo missions, or mini quizzes.</li>
                <li>Plan stamp verification via QR, NFC, or proof-of-task uploads.</li>
                <li>Track stamp payouts directly from the final leaderboard.</li>
              </ul>
            </section>
          </div>
        </div>
      {% endif %}
    </section>
  {% endfor %}
</div>

<section class="leagues-roadmap">
  <h2>Implementation Roadmap</h2>
  <div class="roadmap-grid">
    <article>
      <h3>Phase 1 ¬∑ Foundations</h3>
      <ul>
        <li>Finalize Supabase schemas for leagues, scorecards, matches, and event activities.</li>
        <li>Import legacy CDL and PvP season data for reference leaderboards.</li>
        <li>Design MVP trainer views for scorecards and live brackets.</li>
      </ul>
    </article>
    <article>
      <h3>Phase 2 ¬∑ Live Ops</h3>
      <ul>
        <li>Build admin workflows to open, pause, or close leagues in real time.</li>
        <li>Launch quiz tooling with host dashboards and instant leaderboard updates.</li>
        <li>Ship the first themed limited-time event (Sinistea Halloween party test).</li>
      </ul>
    </article>
    <article>
      <h3>Phase 3 ¬∑ Automation</h3>
      <ul>
        <li>Enable automatic stamp payouts from leaderboards and completed activities.</li>
        <li>Introduce Hall of Fame and lifetime achievement tracking.</li>
        <li>Expand verification (QR scans, NFC taps, uploads) before awarding stamps.</li>
      </ul>
    </article>
  </div>
</section>

<script>
(function () {
  const tabs = document.querySelectorAll(".leagues-tab");
  const panels = document.querySelectorAll(".league-panel");

  tabs.forEach((tab) => {
    tab.addEventListener("click", () => {
      const target = tab.dataset.tab;
      tabs.forEach((t) => t.classList.toggle("is-active", t === tab));
      panels.forEach((panel) => panel.classList.toggle("is-active", panel.dataset.panel === target));
    });
  });
})();
</script>

<style>
.admin-leagues-hero {
  position:relative;
  overflow:hidden;
  border-radius:20px;
  margin-bottom:22px;
  color:#fff;
}
.hero-overlay {
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,#1e3a8a,#9333ea);
  opacity:0.92;
}
.hero-content {
  position:relative;
  z-index:1;
  display:flex;
  justify-content:space-between;
  gap:24px;
  padding:28px;
}
.hero-copy h1 {
  margin:0 0 8px;
}
.hero-copy p {
  margin:0 0 16px;
  max-width:520px;
}
.hero-actions {
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}
.btn-primary,
.btn-secondary {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:10px 18px;
  border-radius:12px;
  font-weight:600;
  text-decoration:none;
  transition:transform 0.15s ease;
}
.btn-primary {
  background:#facc15;
  color:#0f172a;
  box-shadow:0 12px 28px rgba(250,204,21,0.35);
}
.btn-secondary {
  background:rgba(15,23,42,0.25);
  color:#fff;
}
.btn-primary:hover,
.btn-secondary:hover {
  transform:translateY(-1px);
}
.hero-highlights {
  display:grid;
  gap:12px;
  min-width:260px;
}
.highlight-card {
  background:rgba(15,23,42,0.32);
  border-radius:14px;
  padding:16px;
  box-shadow:0 12px 24px rgba(15,23,42,0.35);
  display:flex;
  flex-direction:column;
  gap:6px;
}
.highlight-label {
  font-size:0.75em;
  text-transform:uppercase;
  letter-spacing:0.08em;
  color:rgba(255,255,255,0.75);
}
.leagues-tabs {
  display:flex;
  gap:10px;
  margin-bottom:16px;
  position:sticky;
  top:70px;
  z-index:5;
}
.leagues-tab {
  flex:1;
  padding:10px 14px;
  border:none;
  border-radius:999px;
  background:#e2e8f0;
  font-weight:600;
  cursor:pointer;
  transition:background 0.2s ease, transform 0.15s ease;
}
.leagues-tab.is-active {
  background:#2563eb;
  color:#fff;
  transform:translateY(-1px);
  box-shadow:0 8px 18px rgba(37,99,235,0.28);
}
.leagues-panels {
  position:relative;
}
.league-panel {
  display:none;
  background:#fff;
  border-radius:18px;
  padding:24px;
  box-shadow:0 14px 32px rgba(15,23,42,0.12);
  margin-bottom:22px;
}
.league-panel.is-active {
  display:block;
}
.panel-header {
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:20px;
  margin-bottom:20px;
}
.panel-header h2 {
  margin:0 0 6px;
}
.panel-pill {
  background:#facc15;
  color:#1f2937;
  font-size:0.8em;
  padding:6px 12px;
  border-radius:999px;
  font-weight:600;
  white-space:nowrap;
}
.panel-grid {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
}
.panel-card {
  background:#f8fafc;
  border-radius:16px;
  padding:18px;
  box-shadow:inset 0 0 0 1px rgba(148,163,184,0.2);
}
.panel-card h3 {
  margin-top:0;
}
.panel-card ul,
.panel-card ol {
  margin:12px 0 0;
  padding-left:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.panel-card--wide {
  margin-top:18px;
}
.limited-state-grid {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
  margin-top:20px;
}
.muted {
  color:#64748b;
  font-size:0.9em;
}
.activity-grid {
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:16px;
  margin-top:14px;
}
.activity-card {
  background:#fff;
  border-radius:12px;
  padding:16px;
  box-shadow:0 10px 18px rgba(15,23,42,0.08);
}
.activity-card h4 {
  margin:0 0 8px;
}
.activity-card ul {
  margin:0;
  padding-left:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.leagues-roadmap {
  margin-top:28px;
  background:#fff;
  border-radius:18px;
  padding:24px;
  box-shadow:0 14px 32px rgba(15,23,42,0.12);
}
.leagues-roadmap h2 {
  margin:0 0 14px;
}
.roadmap-grid {
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:16px;
}
.roadmap-grid article {
  background:#f8fafc;
  border-radius:16px;
  padding:20px;
  box-shadow:inset 0 0 0 1px rgba(148,163,184,0.2);
}
.roadmap-grid h3 {
  margin-top:0;
  color:#3a8dde;
}
.roadmap-grid ul {
  margin:10px 0 0;
  padding-left:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

@media (max-width: 960px) {
  .league-profile-callout {
    max-width:none;
  }
  .panel-grid,
  .limited-state-grid,
  .activity-grid,
  .roadmap-grid {
    grid-template-columns:repeat(1,minmax(0,1fr));
  }
}

@media (max-width: 640px) {
  .leagues-tabs {
    flex-direction:column;
  }
  .panel-header {
    flex-direction:column;
    align-items:flex-start;
  }
  .panel-pill {
    margin-top:8px;
  }
  .hero-content {
    flex-direction:column;
  }
  .hero-highlights {
    width:100%;
    grid-template-columns:repeat(1,minmax(0,1fr));
  }
}
</style>

{% endblock %}
