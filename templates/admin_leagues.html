{% extends "base.html" %}

{% block page_settings %}
  {% set container_class = 'is-wide' %}
{% endblock %}

{% block content %}

<div class="leagues-header">
  <div>
    <h1>üèÜ Leagues Control Center</h1>
    <p>Preview the upcoming Leagues experience. Use these panels to plan CDL pipelines, PvP seasons, and live event activities while the build is underway.</p>
  </div>
  <div class="league-profile-callout">
    <h3>League Profile</h3>
    <p>A unified profile will surface each trainer‚Äôs standings, streaks, and rewards across CDL, PvP, and limited-time events.</p>
  </div>
</div>

<div class="leagues-tabs">
  {% for mode in league_modes %}
    <button class="leagues-tab {% if loop.first %}is-active{% endif %}" data-tab="{{ mode.key }}">{{ mode.title }}</button>
  {% endfor %}
</div>

<div class="leagues-panels">
  {% for mode in league_modes %}
    <section class="league-panel {% if loop.first %}is-active{% endif %}" data-panel="{{ mode.key }}">
      <header class="panel-header">
        <div>
          <h2>{{ mode.title }}</h2>
          <p>{{ mode.summary }}</p>
        </div>
        <span class="panel-pill">Phase: Discovery</span>
      </header>

      <div class="panel-grid">
        <article class="panel-card">
          <h3>Core Features</h3>
          <ul>
            {% for item in mode.features %}
              <li>{{ item }}</li>
            {% endfor %}
          </ul>
        </article>
        <article class="panel-card">
          <h3>Future Vision</h3>
          <ul>
            {% for item in mode.future %}
              <li>{{ item }}</li>
            {% endfor %}
          </ul>
        </article>
      </div>

      {% if mode.key == "cdl" %}
        <div class="panel-card panel-card--wide">
          <h3>Data Pipeline Checklist</h3>
          <ol>
            <li>Confirm Supabase sync for the CDL Google Sheet (live standings + archive tables).</li>
            <li>Design trainer-facing scorecards with headline metrics, win/loss charts, and placement badges.</li>
            <li>Surface historical seasons with filters by cup, region, and featured Pok√©mon.</li>
          </ol>
        </div>
      {% elif mode.key == "pvp" %}
        <div class="panel-card panel-card--wide">
          <h3>Live Operations Notes</h3>
          <p>When a meetup league goes live, admins should be able to flip the league status to ‚ÄúLive‚Äù so players begin submitting rounds immediately. Consider on-the-spot updates for:</p>
          <ul>
            <li>Cup rules and restricted Pok√©mon lists.</li>
            <li>Round pairings with real-time progression.</li>
            <li>Live leaderboard refreshes while the meetup runs.</li>
          </ul>
        </div>
      {% elif mode.key == "limited" %}
        <div class="limited-state-grid">
          <article class="panel-card">
            <h3>Inactive State</h3>
            <p>{{ live_event_settings.inactive_copy }}</p>
            <p class="muted">Keep this message as the default when no event is running.</p>
          </article>
          <article class="panel-card">
            <h3>Active Theme Preview</h3>
            <p>Next test event: <strong>{{ live_event_settings.theme }}</strong></p>
            <p>Switching the hub to active mode reveals themed visuals, live activities, and call-to-actions for attendees.</p>
          </article>
        </div>
        <div class="panel-card panel-card--wide">
          <h3>Live Event Activities</h3>
          <div class="activity-grid">
            {% for activity in live_event_settings.activities %}
              <section class="activity-card">
                <h4>{{ activity.title }}</h4>
                <ul>
                  {% for detail in activity.details %}
                    <li>{{ detail }}</li>
                  {% endfor %}
                </ul>
              </section>
            {% endfor %}
            <section class="activity-card">
              <h4>More Ideas</h4>
              <ul>
                <li>Add scavenger hunts, city photo missions, or mini quizzes.</li>
                <li>Plan stamp verification via QR, NFC, or proof-of-task uploads.</li>
                <li>Track stamp payouts directly from the final leaderboard.</li>
              </ul>
            </section>
          </div>
        </div>
      {% endif %}
    </section>
  {% endfor %}
</div>

<section class="leagues-roadmap">
  <h2>Implementation Roadmap</h2>
  <div class="roadmap-grid">
    <article>
      <h3>Phase 1 ¬∑ Foundations</h3>
      <ul>
        <li>Finalize Supabase schemas for leagues, scorecards, matches, and event activities.</li>
        <li>Import legacy CDL and PvP season data for reference leaderboards.</li>
        <li>Design MVP trainer views for scorecards and live brackets.</li>
      </ul>
    </article>
    <article>
      <h3>Phase 2 ¬∑ Live Ops</h3>
      <ul>
        <li>Build admin workflows to open, pause, or close leagues in real time.</li>
        <li>Launch quiz tooling with host dashboards and instant leaderboard updates.</li>
        <li>Ship the first themed limited-time event (Sinistea Halloween party test).</li>
      </ul>
    </article>
    <article>
      <h3>Phase 3 ¬∑ Automation</h3>
      <ul>
        <li>Enable automatic stamp payouts from leaderboards and completed activities.</li>
        <li>Introduce Hall of Fame and lifetime achievement tracking.</li>
        <li>Expand verification (QR scans, NFC taps, uploads) before awarding stamps.</li>
      </ul>
    </article>
  </div>
</section>

<script>
(function () {
  const tabs = document.querySelectorAll(".leagues-tab");
  const panels = document.querySelectorAll(".league-panel");

  tabs.forEach((tab) => {
    tab.addEventListener("click", () => {
      const target = tab.dataset.tab;
      tabs.forEach((t) => t.classList.toggle("is-active", t === tab));
      panels.forEach((panel) => panel.classList.toggle("is-active", panel.dataset.panel === target));
    });
  });
})();
</script>

<style>
.leagues-header {
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:24px;
  margin-bottom:24px;
}
.leagues-header h1 {
  margin:0 0 8px;
}
.league-profile-callout {
  background:#0ea5e9;
  color:#fff;
  padding:16px;
  border-radius:14px;
  box-shadow:0 10px 24px rgba(14,165,233,0.35);
  max-width:280px;
}
.league-profile-callout h3 {
  margin:0 0 6px;
}
.leagues-tabs {
  display:flex;
  gap:12px;
  margin-bottom:18px;
}
.leagues-tab {
  flex:1;
  padding:12px;
  border:none;
  border-radius:12px;
  background:#e2e8f0;
  font-weight:600;
  cursor:pointer;
  transition:background 0.2s ease, transform 0.15s ease;
}
.leagues-tab.is-active {
  background:#3a8dde;
  color:#fff;
  transform:translateY(-2px);
}
.leagues-panels {
  position:relative;
}
.league-panel {
  display:none;
  background:#fff;
  border-radius:16px;
  padding:22px;
  box-shadow:0 12px 28px rgba(15,23,42,0.12);
}
.league-panel.is-active {
  display:block;
}
.panel-header {
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:20px;
  margin-bottom:20px;
}
.panel-header h2 {
  margin:0 0 6px;
}
.panel-pill {
  background:#facc15;
  color:#1f2937;
  font-size:0.8em;
  padding:6px 12px;
  border-radius:999px;
  font-weight:600;
  white-space:nowrap;
}
.panel-grid {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
}
.panel-card {
  background:#f8fafc;
  border-radius:14px;
  padding:18px;
  box-shadow:inset 0 0 0 1px rgba(148,163,184,0.25);
}
.panel-card h3 {
  margin-top:0;
}
.panel-card ul,
.panel-card ol {
  margin:12px 0 0;
  padding-left:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.panel-card--wide {
  margin-top:18px;
}
.limited-state-grid {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
  margin-top:20px;
}
.muted {
  color:#64748b;
  font-size:0.9em;
}
.activity-grid {
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:16px;
  margin-top:14px;
}
.activity-card {
  background:#fff;
  border-radius:12px;
  padding:16px;
  box-shadow:0 10px 18px rgba(15,23,42,0.08);
}
.activity-card h4 {
  margin:0 0 8px;
}
.activity-card ul {
  margin:0;
  padding-left:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.leagues-roadmap {
  margin-top:28px;
  background:#fff;
  border-radius:16px;
  padding:22px;
  box-shadow:0 12px 28px rgba(15,23,42,0.12);
}
.leagues-roadmap h2 {
  margin:0 0 14px;
}
.roadmap-grid {
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:16px;
}
.roadmap-grid article {
  background:#f8fafc;
  border-radius:14px;
  padding:18px;
  box-shadow:inset 0 0 0 1px rgba(148,163,184,0.25);
}
.roadmap-grid h3 {
  margin-top:0;
  color:#3a8dde;
}
.roadmap-grid ul {
  margin:10px 0 0;
  padding-left:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

@media (max-width: 960px) {
  .league-profile-callout {
    max-width:none;
  }
  .panel-grid,
  .limited-state-grid,
  .activity-grid,
  .roadmap-grid {
    grid-template-columns:repeat(1,minmax(0,1fr));
  }
}

@media (max-width: 640px) {
  .leagues-header {
    flex-direction:column;
  }
  .leagues-tabs {
    flex-direction:column;
  }
  .panel-header {
    flex-direction:column;
    align-items:flex-start;
  }
  .panel-pill {
    margin-top:8px;
  }
}
</style>

{% endblock %}
