{% extends "base.html" %}

{% block page_settings %}
  {% set container_class = 'is-cozy' %}
{% endblock %}

{% block content %}
<div class="calendar-page" id="top-of-calendar">
  <header class="calendar-header">
    <h2>Meetup Calendar</h2>
    <p>Plan ahead with every upcoming RDAB meetup. Tap any card for quick RSVP and calendar links.</p>
    {% if public_view %}
      <div class="calendar-cta">
        <a href="{{ url_for('landing') }}" class="btn btn-outline">Back to RDAB</a>
      </div>
    {% endif %}
  </header>

  {% if has_events %}
    <div class="event-stack">
      {% for ev in calendar_events %}
        <article class="event-card">
          {% if ev.cover_photo_url %}
            <div class="event-card__media">
              <img src="{{ ev.cover_photo_url }}" alt="{{ ev.title }}">
            </div>
          {% endif %}
            <div class="event-card__body">
              <header class="event-card__header">
                <div class="event-card__date">
                  <span class="event-card__day">{{ ev.start_local_date }}</span>
                  <span class="event-card__time">{{ ev.start_local_time }} ‚Äì {{ ev.end_local_time }} (UK)</span>
              </div>
              {% if ev.location %}
                <div class="event-card__location">üìç {{ ev.location }}</div>
              {% endif %}
            </header>

            <h3 class="event-card__title">{{ ev.title }}</h3>

            <div class="event-card__actions">
              {% if ev.campfire_url %}
                <a class="btn btn-secondary" href="{{ ev.campfire_url }}" target="_blank" rel="noopener">Campfire</a>
              {% endif %}
              <a class="btn btn-light" href="{{ ev.google_calendar_url }}" target="_blank" rel="noopener">Google</a>
              <a class="btn btn-light" href="{{ ev.ics_url }}">iOS</a>
            </div>
          </div>
        </article>
      {% endfor %}
    </div>

    <div class="back-to-top-wrapper">
      <a href="#top-of-calendar" class="btn back-to-top">Back to top ‚Üë</a>
    </div>
  {% else %}
    <div class="event-empty">
      <h3>No upcoming meetups yet</h3>
      <p>We‚Äôre planning the next adventures ‚Äî check back soon or follow us on Campfire for updates.</p>
    </div>
  {% endif %}
</div>

<style>
.calendar-page { display:flex; flex-direction:column; gap:18px; }
.calendar-header {
  background:#fff;
  padding:18px;
  border-radius:18px;
  border:1px solid rgba(148,163,184,0.2);
  box-shadow:0 10px 22px rgba(15,23,42,0.12);
  position:static;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.calendar-header h2 { margin:0; font-size:1.6rem; color:#0f172a; }
.calendar-header p { margin:0; color:#4b5563; }
.calendar-cta { display:flex; flex-wrap:wrap; gap:10px; }

.event-stack { display:flex; flex-direction:column; gap:18px; }
.event-card {
  display:flex;
  flex-direction:column;
  background:#fff;
  border-radius:20px;
  box-shadow:0 14px 28px rgba(15,23,42,0.16);
  overflow:hidden;
  text-align:left;
}
.event-card__media img {
  width:100%;
  height:210px;
  object-fit:cover;
}
.event-card__body {
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:12px;
  align-items:flex-start;
}
.event-card__header {
  display:flex;
  flex-direction:column;
  gap:6px;
}
.event-card__date {
  display:flex;
  flex-direction:column;
  gap:4px;
  font-weight:600;
  color:#1f2937;
}
.event-card__time { font-size:0.88rem; color:#1f2937; }
.event-card__location { font-size:0.92rem; color:#475569; font-weight:600; }
.event-card__title { margin:0; font-size:1.18rem; color:#0f172a; }
.event-card__actions { display:flex; gap:8px; align-items:center; justify-content:flex-start; flex-wrap:nowrap; width:100%; }

.btn {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:8px 16px;
  border-radius:999px;
  background:#3a8dde;
  color:#fff;
  text-decoration:none;
  font-weight:600;
  font-size:0.82rem;
  box-shadow:0 6px 14px rgba(58,141,222,0.26);
  transition:transform .15s ease, box-shadow .15s ease;
}
.btn:hover { transform:translateY(-1px); box-shadow:0 10px 20px rgba(58,141,222,0.28); }
.btn-secondary { background:#f97316; box-shadow:0 6px 14px rgba(249,115,22,0.28); }
.btn-light { background:#fff; color:#2563eb; border:1px solid rgba(148,163,184,0.6); box-shadow:none; }
.btn-light:hover { background:#f1f5f9; }
.btn-outline { background:transparent; color:#1f2937; border:1px solid rgba(148,163,184,0.6); box-shadow:none; }
.btn-outline:hover { background:#f1f5f9; }

.event-empty {
  background:#fff;
  border-radius:20px;
  padding:24px;
  text-align:center;
  box-shadow:0 12px 24px rgba(15,23,42,0.12);
  display:flex;
  flex-direction:column;
  gap:10px;
  color:#475569;
}
.event-empty h3 { margin:0; color:#0f172a; }

.back-to-top-wrapper {
  display:flex;
  justify-content:center;
  margin-top:10px;
}
.back-to-top {
  background:#0ea5e9;
  box-shadow:0 6px 16px rgba(14,165,233,0.28);
}

.muted { color:#6b7280; font-size:0.85rem; }

@media (max-width:640px){
  .event-card__body { padding:18px; }
  .event-card__actions { flex-wrap:wrap; }
  .event-card__actions .btn { flex:1 1 calc(33.33% - 6px); justify-content:center; font-size:0.78rem; padding:8px; }
}
</style>
{% endblock %}
