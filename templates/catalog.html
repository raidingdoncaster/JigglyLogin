{% extends "base.html" %}
{% block content %}

<div class="catalog-hero">
  <div class="catalog-icon"></div>
  <div class="catalog-title">
    <h1>catalog</h1>
    <p>{{ catalog_description }}</p>
    <a href="{{ url_for('dashboard') }}" class="back-link">&lt; back to dashboard</a>
  </div>
</div>

<!-- Featured Carousel -->
<div class="featured-carousel">
  <div class="carousel-track">
    {% for f in featured_items %}
    <div class="carousel-slide" style="background-image:url('{{ f.image_url }}');">
      <div class="carousel-content">
        <h2>{{ f.name }}</h2>
        <p>{{ f.description or '' }}</p>
        <a href="{{ url_for('catalog_item', item_id=f.id) }}" class="btn-primary">View</a>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Controls -->
  <div class="carousel-controls">
    <button class="carousel-prev">‹</button>
    <div class="carousel-dots">
      {% for f in featured_items %}
      <span class="dot {% if loop.first %}active{% endif %}"></span>
      {% endfor %}
    </div>
    <button class="carousel-next">›</button>
  </div>
</div>

<div class="carousel-progress">
  <div class="progress-bar"></div>
</div>

<!-- Quick Links -->
<div class="quick-links">
  <a href="#" class="quick-link">New here? Tap here to learn how it works!</a>
  <a href="{{ url_for('orders') }}" class="quick-link">Order history</a>
  <button class="watchlist-btn" onclick="toggleWatchlist()">
    <img src="{{ url_for('static', filename='icons/binoculars.png') }}" alt="Watchlist">
  </button>
</div>

<!-- Categories -->
<section class="categories">
  <h2>Categories</h2>
  <div class="category-grid">
    {% for cat in category_order %}
    <a href="#cat-{{ cat|lower }}" class="category-btn">{{ cat }}</a>
    {% endfor %}
  </div>
</section>

<!-- Search + Filter -->
<div class="search-bar">
  <input type="text" placeholder="🔍 Search" id="catalog-search">
  <div class="filters">
    <button>Filter</button>
    <button>Sort</button>
    <button>Grid</button>
    <button>List</button>
  </div>
</div>

<!-- Item Grid -->
<section class="item-grid">
  {% for it in items %}
  <div class="item-card">
    <div class="item-thumb" style="background-image:url('{{ it.image_url }}')">
      <span class="cost">🪙 {{ it.cost_stamps }}</span>
      <button class="watch-btn" data-id="{{ it.id }}" onclick="toggleWatch(this)">
        👀
      </button>
    </div>
    <div class="item-meta">
      <h3>{{ it.name }}</h3>
      <p class="desc">{{ it.description }}</p>
      <div class="tags">
        {% for t in it.tags %}
        <span class="tag">#{{ t }}</span>
        {% endfor %}
      </div>
    </div>
    <div class="item-actions">
      <a href="{{ url_for('catalog_item', item_id=it.id) }}" class="buy-btn">
        Buy / View
      </a>
    </div>
  </div>
  {% endfor %}
</section>

<!-- Back to Top -->
<div class="back-to-top">
  <a href="#">Back to top</a>
</div>

<!-- Watchlist Modal -->
<div id="watchlist-modal" class="modal hidden">
  <div class="modal-content">
    <h2>👀 Your Watchlist</h2>
    <div id="watchlist-items">Loading...</div>
    <button onclick="toggleWatchlist()" class="close-btn">Close</button>
  </div>
</div>

<script src="{{ url_for('static', filename='catalog.js') }}"></script>

{% endblock %}