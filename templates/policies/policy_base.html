{% extends "base.html" %}
{% block content %}

<div class="policy-shell" data-is-pwa="{{ 'true' if is_pwa else 'false' }}">
  <header class="policy-header">
    <div class="policy-meta">
      <p class="policy-eyebrow">RDAB Policies</p>
      <h1>{{ policy.title }}</h1>
      {% if policy.subtitle %}
        <p class="policy-subtitle">{{ policy.subtitle }}</p>
      {% endif %}
    </div>
    <div class="policy-actions">
      {% if is_pwa %}
        <a href="{{ url_for('dashboard') }}" class="btn-action">⬅ Go back to the dashboard</a>
      {% else %}
        <a href="https://rdab.app" class="btn-action" target="_blank" rel="noopener">⬅ Back to rdab.app</a>
      {% endif %}
    </div>
  </header>

  <article class="policy-content">
    {% block policy_content %}{% endblock %}
  </article>

  <section class="policy-footer">
    <p class="disclaimer">
      This is a programme run entirely by volunteers from the ‘Raiding Doncaster and Beyond’ Campfire group and is in no way affiliated with The Pokémon Company or Niantic.
      All competitions, giveaways, prize draws, passports and prize redemption are entirely free and there are no monetary gains.
      For support, please contact the RDAB admin team via the Niantic Campfire app.
    </p>
  </section>

  {% if is_pwa %}
  <button type="button" id="policyBackToTop" class="policy-top-btn" aria-label="Back to top">▲</button>
  {% endif %}
</div>

<style>
.policy-shell{
  position:relative;
  display:flex;
  flex-direction:column;
  gap:24px;
}

.policy-header{
  background:linear-gradient(135deg,#1d4ed8,#22d3ee);
  color:#f8fafc;
  padding:28px 24px;
  border-radius:20px;
  box-shadow:0 18px 40px rgba(15,23,42,0.35);
  display:flex;
  flex-direction:column;
  gap:18px;
}
.policy-meta{display:flex;flex-direction:column;gap:8px;}
.policy-eyebrow{text-transform:uppercase;letter-spacing:0.3em;font-weight:600;font-size:0.75rem;opacity:0.85;}
.policy-header h1{margin:0;font-size:1.9rem;line-height:1.2;}
.policy-subtitle{margin:0;font-size:1rem;color:rgba(241,245,249,0.85);}
.policy-actions .btn-action{
  display:inline-flex;align-items:center;justify-content:center;padding:10px 16px;background:rgba(15,23,42,0.25);
  color:#f8fafc;text-decoration:none;border-radius:999px;font-weight:600;border:1px solid rgba(255,255,255,0.35);
}

.policy-content{
  background:#fff;
  border-radius:18px;
  padding:24px 26px;
  box-shadow:0 12px 28px rgba(15,23,42,0.18);
  line-height:1.75;
  color:#0f172a;
}
.policy-content h2{margin-top:1.6rem;font-size:1.3rem;color:#1d4ed8;}
.policy-content h3{margin-top:1.2rem;font-size:1.1rem;color:#0f172a;}
.policy-content p{margin:0.8rem 0;}
.policy-content ul{padding-left:1.2rem;margin:0.8rem 0;}
.policy-content li{margin:0.5rem 0;}

.policy-footer{
  font-size:0.85rem;
  color:#475569;
  background:rgba(241,245,249,0.9);
  padding:16px;
  border-radius:14px;
  line-height:1.6;
}

.policy-top-btn{
  position:fixed;
  right:22px;
  bottom:28px;
  width:54px;
  height:54px;
  border-radius:50%;
  border:none;
  background:linear-gradient(135deg,#22d3ee,#3b82f6);
  color:#0f172a;
  font-size:1.2rem;
  font-weight:700;
  box-shadow:0 16px 30px rgba(59,130,246,0.35);
  cursor:pointer;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:4000;
}

@media(max-width:540px){
  .policy-header{padding:24px 20px;}
  .policy-header h1{font-size:1.6rem;}
  .policy-content{padding:20px 18px;}
  .policy-top-btn{width:48px;height:48px;}
}
</style>

{% if is_pwa %}
<script>
  (function(){
    const btn = document.getElementById('policyBackToTop');
    if(!btn) return;
    function toggle(){
      if(window.scrollY > 220){ btn.style.display='flex'; }
      else{ btn.style.display='none'; }
    }
    toggle();
    window.addEventListener('scroll', toggle, { passive: true });
    btn.addEventListener('click', ()=>{
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  })();
</script>
{% endif %}

{% endblock %}
